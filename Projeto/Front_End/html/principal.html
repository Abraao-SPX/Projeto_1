<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Tela Principal</title>
  <link rel="stylesheet" href="../css/principal.css">
</head>
<body>
  <header class="main-header">
    <div class="container">
      <h1>Bem-vindo(a) ao Sistema</h1>
      <p id="welcomeMessage">Você entrou com sucesso.</p>
      <a href="#" id="logoutBtn" class="btn-secondary">Sair / Logout</a>
    </div>
  </header>
  <main class="container">
    <section class="panel">
      <h2>Área Principal</h2>
      <p>Esta é uma página inicial simples. Substitua pelo conteúdo real do seu projeto.</p>
    </section>
  </main>
  <script>
    // Tenta mostrar o email salvo no localStorage (se houver)
    document.addEventListener('DOMContentLoaded', () => {
      const token = localStorage.getItem('auth_token');
      const msg = document.getElementById('welcomeMessage');
      if (token) {
        // Pegar perfil via API
        fetch('http://localhost:3000/api/profile', {
          headers: { 'Authorization': `Bearer ${token}` }
        })
        .then(res => res.json())
        .then(data => {
          if (data && data.nome) msg.textContent = `Você está conectado como ${data.nome} (${data.email}).`;
          else {
            const email = localStorage.getItem('email_salvo');
            if (email) msg.textContent = `Você está conectado como ${email}.`;
          }
        })
        .catch(() => {
          const email = localStorage.getItem('email_salvo');
          if (email) msg.textContent = `Você está conectado como ${email}.`;
        });
      } else {
        const email = localStorage.getItem('email_salvo');
        if (email) msg.textContent = `Você está conectado como ${email}.`;
      }
      // Logout - limpa localStorage e redireciona para login
      const logoutBtn = document.getElementById('logoutBtn');
      if (logoutBtn) {
      logoutBtn.addEventListener('click', (e) => {
        e.preventDefault();
        localStorage.removeItem('email_salvo');
        localStorage.removeItem('auth_token');
        window.location.href = './login.html';
      });
      }
    });
  </script>
</body>
</html>